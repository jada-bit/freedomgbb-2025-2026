const players = [
    {name: "Brittney Tang", num: 1}, {name: "Kylie Mulcahy", num: 2},
    {name: "Mikayla Sanders", num: 3}, {name: "Lexi Guild", num: 4},
    {name: "Natasha Mistry", num: 5}, {name: "Reese Jackson", num: 10},
    {name: "Alexa Troiano", num: 15}, {name: "Bela Smith", num: 20},
    {name: "Christina Lisack", num: 22}, {name: "Olivia Dozier", num: 23},
    {name: "Gia Comey", num: 32}, {name: "Dani Cardona", num: 34},
    {name: "Olivia Fraser", num: 44}
];

function calculateSeasonStats() {
    const history = JSON.parse(localStorage.getItem('gameHistory') || '[]');
    const statsMeta = {}; // To store totals, highs, and lows

    // Initialize meta-structure for all stats on your sheet
    const categories = ['pts', 'reb', 'ast', 'stl', 'to', 'fouls'];
    
    players.forEach(p => {
        statsMeta[p.name] = { gp: 0 };
        categories.forEach(cat => {
            statsMeta[p.name][cat] = { total: 0, high: 0, low: Infinity };
        });
    });

    history.forEach(game => {
        game.stats.forEach(s => {
            const p = statsMeta[s.name];
            p.gp++;
            categories.forEach(cat => {
                const val = s[cat] || 0;
                p[cat].total += val;
                if (val > p[cat].high) p[cat].high = val;
                if (val < p[cat].low) p[cat].low = val;
            });
        });
    });

    renderSummaryTable(statsMeta);
}

function renderSummaryTable(data) {
    const container = document.getElementById('seasonTableContainer');
    let html = `
        <h3 class="text-xl font-bold mt-8 mb-4 text-blue-900">Season Highs & Lows</h3>
        <table class="w-full text-xs text-left border-collapse bg-white shadow-sm">
            <thead>
                <tr class="bg-blue-900 text-white">
                    <th class="p-2 border">Player</th>
                    <th class="p-2 border">Points (H/L)</th>
                    <th class="p-2 border">Rebounds (H/L)</th>
                    <th class="p-2 border">Assists (H/L)</th>
                    <th class="p-2 border">Steals (H/L)</th>
                    <th class="p-2 border">Turnovers (H/L)</th>
                </tr>
            </thead>
            <tbody>`;

    for (let name in data) {
        const p = data[name];
        if (p.gp === 0) continue;
        
        html += `
            <tr class="border-b">
                <td class="p-2 font-bold border bg-gray-50">${name}</td>
                <td class="p-2 border text-center"><span class="text-green-600 font-bold">${p.pts.high}</span> / <span class="text-red-600">${p.pts.low}</span></td>
                <td class="p-2 border text-center"><span class="text-green-600 font-bold">${p.reb.high}</span> / <span class="text-red-600">${p.reb.low}</span></td>
                <td class="p-2 border text-center"><span class="text-green-600 font-bold">${p.ast.high}</span> / <span class="text-red-600">${p.ast.low}</span></td>
                <td class="p-2 border text-center"><span class="text-green-600 font-bold">${p.stl.high}</span> / <span class="text-red-600">${p.stl.low}</span></td>
                <td class="p-2 border text-center"><span class="text-red-600 font-bold">${p.to.high}</span> / <span class="text-green-600">${p.to.low}</span></td>
            </tr>`;
    }
    html += `</tbody></table>`;
    container.innerHTML = html;
}
